<ion-header class="custom-header" translucent="true">
  <!-- Main Header Bar -->
  <div class="header-container">
    <!-- Brand Name -->
    <div class="brand-section">
      <div class="brand-title">Kamatchi SuperMart</div>
            </div>

    <!-- Delivery Location & User Profile -->
    <div class="actions-section">
      <!-- Delivery Info -->
      <div class="delivery-info">
        <ion-icon name="location-outline" class="location-icon"></ion-icon>
        <div class="delivery-details">
          <span class="deliver-to">Deliver to</span>
          <div class="location-selector">
            <span class="location-name">Chennai</span>
            <ion-icon name="chevron-down-outline" class="dropdown-icon"></ion-icon>
          </div>
        </div>
      </div>

      <!-- Delivery Status Badge -->
      <div class="delivery-status">
        <span class="status-text">Delivers in</span>
        <span class="status-badge">Slots Full</span>
      </div>

      <!-- Profile Icon -->
      <ion-buttons class="profile-button" (click)="alertEnabler()">
        <ion-avatar class="profile-avatar">

          <img src="../../assets/bell-solid-full.svg" class="profile-icon" />
        </ion-avatar>
      </ion-buttons>
    </div>
  </div>

  <!-- Search Bar -->
  <div class="search-container">
    <i class="fa-solid fa-magnifying-glass search-icon"></i>
    <input type="text" class="search-input" placeholder="Search 18000+ products" [(ngModel)]="searchText"
      (input)="onSearchChange()" />

    <!-- Suggestion Box -->
    <div class="suggestion-box" *ngIf="filteredSuggestions.length > 0">
      <div class="suggestion-item" *ngFor="let suggestion of filteredSuggestions"
        (click)="selectSuggestion(suggestion)">
        <i class="fa-solid fa-clock-rotate-left icon"></i>
        <span class="text">{{ suggestion }}</span>
      </div>
    </div>
</div>


</ion-header>

    <!-- Categories -->
  <div class="content">

    <div class="categories-scroll">
      <div class="category" *ngFor="let cat of categories">
        <div class="cat-displayer">
          <img src="../../assets/shapes.svg" />
          <p>{{cat.name}}</p>
        </div>

      </div>
    </div>
  </div>


<ion-content style="padding: 20px;overflow-y: auto;--background:fff" fullscreen="true">

<div class="bg" *ngIf="showAlert">
    <div class="backdrop" (click)="alertEnabler()"></div>
    <!-- Alert Container -->
  <div class="alert-container" id="alertContainer" >
        <div class="alert-dialog" style="position: absolute;top:30%; display: block;height: 18%;width: 80%;">
            <div class="alert-title">
                <h2>Alert!</h2>
            </div>
            <div class="alert-buttons">
                <button class="alert-button" (click)="alertEnabler()" >Cancel</button>
                <button class="alert-button"  (click)="alertEnabler()"  >OK</button>
            </div>
        </div>
    </div>
</div>

  <!-- Section Tabs -->
  <div class="tabs">
    <span class="active">Popular</span>
    <span>Flash Sale</span>
    <span>New Arrival</span>
  </div>


  <div class="product-grid">
    <div *ngFor="let item of products" class="product-card">
      <div class="like" (click)="addWishlist(item)">
        <i class="fa-regular fa-heart" *ngIf="!item.isLiked" style="color: #6b1b6c;"></i>
        <i class="fa-solid fa-heart" *ngIf="item.isLiked" style="color: #e64e33;"></i>
      </div>

      <img src="../../assets/vege.jpg" alt="product" class="product-image" />

      <div class="product-content">
        <h3>{{ item.name }}</h3>
        <p class="weight">{{ item.weight }}</p>

        <div class="price-row">
          <span class="price" style="width: 30%;">${{ item.price }}</span>

          <div class="add-btn" style="width: 70%;" *ngIf="!item.isAdded">
            <button class="add-button" (click)="onAdd(item)">Add</button>
          </div>

          <div class="count" style="width: 70%;display: flex;gap: 2px;" *ngIf="item.isAdded">
            <button class="decrease" (click)="onRemove(item)">-</button>
            <input type="number" class="quantity" [value]="getQuantity(item)"
              style="width: 60%;background-color: aliceblue;border: 1px solid gray;border-radius: 4px;color:#000" />
            <button class="increase" (click)="onAdd(item)">+</button>
          </div>
        </div>
      </div>
    </div>
  </div>


  <div    class="footer draggable" cdkDrag>
 
      <button class="nav-btn" [ngClass]="{ 'active': isWishlist }" (click)="togglePanel();setActive('Wishlist')">
        <div class="icon-wrapper">
          <img src="../../assets/heart-solid-full.svg" class="profile-icon" />
        </div>
        <span class="nav-label">Wishlist</span>
        <span class="badge">{{ wishlist.length }}</span>
      </button>

      <!-- Home -->
      <button class="nav-btn" [ngClass]="{ 'active': isHome }" (click)="setActive('Home')">
        <div class="icon-wrapper">
          <img src="../../assets/house-solid-full.svg" class="profile-icon" />
        </div>
        <span class="nav-label">Home</span>
      </button>

      <!-- Profile -->
      <button class="nav-btn" [ngClass]="{ 'active': isProfile }" (click)="togglePanel();setActive('Profile')">
        <div class="icon-wrapper">
          <img src="../../assets/user-solid-full.svg" class="profile-icon" />
        </div>
        <span class="nav-label">Profile</span>
      </button>
      <!-- Cart -->
      <button class="nav-btn" [ngClass]="{ 'active': isCart }" (click)="togglePanel();this.setActive('Cart')">
        <div class="icon-wrapper">
          <img src="../../assets/cart-shopping-solid-full.svg" class="profile-icon" />
          <span class="badge">{{ selectedProduct.length }}</span>
        </div>
        <span class="nav-label">Cart</span>
      </button>


      <!-- <button class="nav-btn" onclick="setActive(this)">
        <div class="icon-wrapper">
          <img src="../../assets/credit-card-solid-full.svg" class="profile-icon" />
        </div>
        <span class="nav-label">Categories</span>
      </button> -->
      <!-- Wishlist -->
    

    
  </div>

      <!-- Backdrop -->

    <!-- Alert Container -->
   

</ion-content>



  <!-- SIDE PANEL (slides in/out) -->
  <div class="side-panel" [class.open]="isPanelOpen">
    <div class="panel-header">
      <div class="panel-head" *ngIf="isCart">
        <button class="close-btn" (click)="setActive('Home');togglePanel(); "> <i class="fa-solid fa-chevron-left"></i></button>
         <h4 style="margin: 0px 0px 0px 10px;">Items in Cart</h4>
      </div>
      <div class="panel-head" *ngIf="isWishlist">
       <button class="close-btn" (click)="setActive('Home');togglePanel(); ;"><i class="fa-solid fa-chevron-left"></i></button>
        <h4 style="margin: 0px 0px 0px 10px;">Items you Liked</h4> 
      </div>
       <div class="panel-head" *ngIf="isProfile">
         <button class="close-btn" (click)="setActive('Home');togglePanel();"><i class="fa-solid fa-chevron-left"></i></button>
         <h4 style="margin: 0px 0px 0px 10px;">Profile Information</h4>
      </div>
    </div>
    <div class="cart-list" style="flex: 1;overflow: auto;" *ngIf="isCart">
      <div class="cart-section">
        <div *ngFor="let item of selectedProduct" class="cart-item">


          <div class="product-card">
 <div class="like" (click)="removeFromCart(item)">
       <i class="fa-regular fa-circle-xmark" style="color: #a453d0;"></i>
      </div>
            <img src="../../assets/vege.jpg" alt="product" class="product-image" />

            <div class="product-content">
              <h3>{{ item.name }}</h3>
              <p class="weight">{{ item.weight }}</p>

              <div class="price-row">
                <span class="price" style="width: 30%;">${{ item.price }}</span>

                <div class="add-btn" style="width: 70%;" *ngIf="!item.isAdded">
                  <button class="add-button" (click)="onAdd(item)">Add</button>
                </div>

                <div class="count" style="width: 70%;display: flex;gap: 2px;" *ngIf="item.isAdded">
                  <button class="decrease" (click)="onRemove(item)">-</button>
                  <input type="number" class="quantity" [value]="getQuantity(item)"
                    style="width: 60%;background-color: aliceblue;border: 1px solid gray;border-radius: 4px;" />
                  <button class="increase" (click)="onAdd(item)">+</button>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="no-item" *ngIf="selectedProduct.length === 0">
          No products in the cart
        </div>
      </div>
      <div class="panel-footer" style="height: 10%;">
        <div class="total">Total: ${{ totalPrice }}</div>
        <div class="cart-buttons">
          <button class="checkout-btn" (click)="sendmail()">Payment</button>
          <button class="checkout-btn" (click)="clearCart()">Clear Cart</button>
        </div>
      </div>
    </div>
    <div class="wish-list" *ngIf="isWishlist">
      <div class="cart-section">
        <div *ngFor="let item of wishlist" class="cart-item">
          <div class="product-card">
             <div class="like" (click)="removeFromWishlist(item)">
       <i class="fa-regular fa-circle-xmark" style="color: #a453d0;"></i>
      </div>

            <img src="../../assets/vege.jpg" alt="product" class="product-image" />

            <div class="product-content">
              <h3>{{ item.name }}</h3>
              <p class="weight">{{ item.weight }}</p>

              <div class="price-row">
                <span class="price" style="width: 30%;">${{ item.price }}</span>

                <div class="add-btn" style="width: 70%;" *ngIf="!item.isAdded">
                  <button class="add-button" (click)="onAdd(item)">Add</button>
                </div>

                <div class="count" style="width: 70%;display: flex;gap: 2px;" *ngIf="item.isAdded">
                  <button class="decrease" (click)="onRemove(item)">-</button>
                  <input type="number" class="quantity" [value]="getQuantity(item)"
                    style="width: 60%;background-color: aliceblue;border: 1px solid gray;border-radius: 4px;" />
                  <button class="increase" (click)="onAdd(item)">+</button>
                </div>
              </div>
            </div>
          </div>
          <div class="no-item" *ngIf="wishlist.length === 0">
            No products in the wishlist
          </div>
        </div>
      </div>
       <div class="panel-footer" style="height: 10%;">
        <div class="total">Total: ${{ totalPrice }}</div>
        <div class="cart-buttons">
          <button class="checkout-btn">Payment</button>
          <button class="checkout-btn" (click)="clearCart()">Clear Wishlist</button>
        </div>
      </div>
    </div>
    <div class="profile-details" *ngIf="isProfile">
      <div class="user-details">
       <div class="profile-img" >
          <img src="../../assets/shivan.jpg" alt="User Profile" class="profile-image" style="border-radius: 50%;"/>
       </div>
       <div class="camera">
               <i class="fa-solid fa-camera"></i>

       </div>
        <mat-form-field appearance="outline">
          <mat-label>Name</mat-label>
          <input matInput placeholder="Enter your name" [(ngModel)]="userName" />
        </mat-form-field>
         <mat-form-field appearance="outline">
          <mat-label>Email</mat-label>
          <input matInput placeholder="xyz@gmail.com"  [(ngModel)]="email"/>
        </mat-form-field>
         <mat-form-field appearance="outline">
          <mat-label>Phone</mat-label>
          <input matInput placeholder="9989878767" [(ngModel)]="phoneNumber"/>
        </mat-form-field>
         <mat-form-field appearance="outline">
          <mat-label>Delivery Address</mat-label>
          <input matInput placeholder="123, salem Tamilnadu" [(ngModel)]="address"/>
        </mat-form-field>
 <div class="panel-footer" style="height: 10%;">
        <div class="cart-buttons">
          <button class="checkout-btn" (click)="saveUserData()">Save</button>
          <button class="checkout-btn" (click)="clearCart()">Clear </button>
        </div>
      </div>
      </div>
    </div>
  </div>

  <div class="overlay" [class.show]="isPanelOpen" (click)="togglePanel()"></div>


<!-- <footer class="custom-footer">
 
    <ion-buttons slot="start">
      <ion-button>
        <ion-icon name="home-outline"></ion-icon>
        <span>Home</span>
      </ion-button>
      <ion-button>
        <ion-icon name="grid-outline"></ion-icon>
        <span>Categories</span>
      </ion-button>
      <ion-button>
        <ion-icon name="person-outline"></ion-icon>
        <span>Profile</span>
      </ion-button>
    </ion-buttons>
</footer> -->